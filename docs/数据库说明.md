# æ•°æ®åº“è¯´æ˜æ–‡æ¡£

## ğŸ“Š æ•°æ®åº“åŸºæœ¬ä¿¡æ¯

- **æ•°æ®åº“åç§°**: `marine_survey_db`
- **å­—ç¬¦é›†**: `utf8mb4`
- **æ€»è¡¨æ•°**: 10 å¼ 
- **å¤‡ä»½æ–‡ä»¶**: `marine_survey_db_latest.sql`
- **æœ€åæ›´æ–°**: 2025-09-30

---

## ğŸ“‹ æ•°æ®è¡¨æ¸…å•

### 1. ç”¨æˆ·ç›¸å…³è¡¨

#### `tb_user` - ç”¨æˆ·è¡¨
**åŠŸèƒ½**: å­˜å‚¨ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ï¼Œæ”¯æŒç”¨æˆ·éš”ç¦»

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|--------|------|------|------|
| `id` | INT | ç”¨æˆ·IDï¼ˆä¸»é”®ï¼‰ | è‡ªå¢, ä¸»é”® |
| `name` | VARCHAR(45) | ç”¨æˆ·å | å”¯ä¸€, éç©º |
| `login_name` | VARCHAR(45) | ç™»å½•å | - |
| `password` | VARCHAR(45) | å¯†ç  | - |
| `sex` | VARCHAR(45) | æ€§åˆ« | - |
| `role` | VARCHAR(45) | è§’è‰² | - |
| `desc` | VARCHAR(45) | æè¿° | - |
| `permission` | VARCHAR(45) | æƒé™ | - |
| `department` | VARCHAR(255) | éƒ¨é—¨ | éç©º |

**åˆå§‹æ•°æ®**:
- ID=1: 111 (æµ‹è¯•ç”¨æˆ·)
- ID=2: 12
- ID=3: 123 (æ™®é€šç”¨æˆ·)
- ID=4: admin (è¶…çº§ç®¡ç†å‘˜)
- ID=12: 1234 (æ–°ç”¨æˆ·)

**é‡è¦**: 
- `id` æ˜¯è‡ªå¢ä¸»é”®ï¼Œç”¨äºç”¨æˆ·éš”ç¦»
- æ‰€æœ‰ç°æœ‰ä»»åŠ¡é»˜è®¤å…³è”åˆ° `user_id=3` (ç”¨æˆ·123)

---

### 2. ä»»åŠ¡ç›¸å…³è¡¨

#### `tb_task_info` - ä»»åŠ¡ä¿¡æ¯è¡¨
**åŠŸèƒ½**: å­˜å‚¨èˆªæ¬¡ä»»åŠ¡çš„åŸºæœ¬ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|--------|------|------|------|
| `task_name` | VARCHAR(100) | ä»»åŠ¡åç§° | ä¸»é”® |
| `task_code` | VARCHAR(100) | ä»»åŠ¡ç¼–å· | - |
| `project` | VARCHAR(100) | ä¸“é¡¹åç§° | - |
| `undertake` | VARCHAR(100) | æ‰¿æ‹…å•ä½ | - |
| `participant` | VARCHAR(200) | å‚ä¸å•ä½ | - |
| `ship` | VARCHAR(45) | è°ƒæŸ¥èˆ¹ | - |
| `leader` | VARCHAR(45) | ä»»åŠ¡è´Ÿè´£äºº | - |
| `chief_scientist` | VARCHAR(45) | é¦–å¸­ç§‘å­¦å®¶ | - |
| `superintendent` | VARCHAR(100) | éšèˆ¹ç›‘ç£å‘˜ | - |
| `superintended` | VARCHAR(45) | éšèˆ¹ç›‘ç£ | - |
| `executiontime` | TEXT | æ‰§è¡Œæ—¶é—´ | - |
| `subject` | VARCHAR(45) | ä»»åŠ¡å­¦ç§‘ | - |
| **`user_id`** | **INT** | **åˆ›å»ºç”¨æˆ·ID** | **é»˜è®¤3** |

**ç”¨æˆ·éš”ç¦»**:
- `user_id` å…³è”åˆ° `tb_user.id`
- æ¯ä¸ªç”¨æˆ·åªèƒ½çœ‹åˆ°è‡ªå·±åˆ›å»ºçš„ä»»åŠ¡
- ç°æœ‰ä»»åŠ¡çš„ `user_id=3`

#### `tb_task_hqzljdjcjlb` - èˆªå‰è´¨é‡ç›‘ç£æ£€æŸ¥è®°å½•è¡¨
**åŠŸèƒ½**: å­˜å‚¨èˆªå‰æ£€æŸ¥çš„è¯¦ç»†è®°å½•

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|--------|------|------|------|
| `task_name` | VARCHAR(100) | ä»»åŠ¡åç§°ï¼ˆå¤–é”®ï¼‰ | ä¸»é”® |
| `check_date` | DATE | æ£€æŸ¥æ—¥æœŸ | - |
| `superintendent` | VARCHAR(100) | ç›‘ç£å‘˜ | - |
| `superintended` | VARCHAR(100) | è¢«ç›‘ç£æ–¹ | - |
| `check_1` ~ `check_11` | TEXT | æ£€æŸ¥å†…å®¹1~11 | - |
| `check_1_problem` ~ `check_11_problem` | TEXT | å­˜åœ¨é—®é¢˜1~11 | - |
| `check_detail` | TEXT | æ£€æŸ¥è¯¦æƒ… | - |
| `check_result` | TEXT | æ£€æŸ¥ç»“æœ | - |
| `chief_scientist_sign` | VARCHAR(45) | é¦–å¸­ç§‘å­¦å®¶ç­¾å­— | - |
| `check_leader_sign` | VARCHAR(45) | æ£€æŸ¥è´Ÿè´£äººç­¾å­— | - |
| `chief_scientist_signdate` | DATE | é¦–å¸­ç§‘å­¦å®¶ç­¾å­—æ—¥æœŸ | - |
| `check_leader_signdate` | DATE | æ£€æŸ¥è´Ÿè´£äººç­¾å­—æ—¥æœŸ | - |
| **`user_id`** | **INT** | **åˆ›å»ºç”¨æˆ·ID** | **é»˜è®¤3** |

**æ£€æŸ¥é¡¹è¯´æ˜**:
1. æ£€æŸ¥å†…å®¹1: ä»»åŠ¡æ¥æºåŠä¸‹è¾¾çš„æ‰¹å¤æ€§æ–‡ä»¶ï¼ˆä»»åŠ¡é€šçŸ¥ä¹¦ã€ä»»åŠ¡ä¹¦ï¼‰
2. æ£€æŸ¥å†…å®¹2: ä»»åŠ¡è®¾è®¡ä¹¦ã€å®æ–½æ–¹æ¡ˆã€æŠ€æœ¯è§„ç¨‹ã€è´¨é‡è¦æ±‚ç­‰
3. æ£€æŸ¥å†…å®¹3: ä»ªå™¨è®¾å¤‡é…ç½®åŠæ£€å®š/æ ¡å‡†
4. æ£€æŸ¥å†…å®¹4: è°ƒæŸ¥äººå‘˜èµ„è´¨åŠå²—å‰åŸ¹è®­
5. æ£€æŸ¥å†…å®¹5: ä»»åŠ¡å„é˜¶æ®µå·¥ä½œåŠè¿›åº¦ã€æˆæœè®¡åˆ’å®‰æ’
6. æ£€æŸ¥å†…å®¹6: ç«™ä½å¸ƒè®¾
7. æ£€æŸ¥å†…å®¹7: è°ƒæŸ¥èˆ¹èˆ¶åŠè°ƒæŸ¥å¹³å°ä½¿ç”¨
8. æ£€æŸ¥å†…å®¹8: åº”æ€¥é¢„æ¡ˆ
9. æ£€æŸ¥å†…å®¹9: ç¯ä¿å’Œå®‰å…¨æªæ–½
10. æ£€æŸ¥å†…å®¹10: å¤–ååˆ†åŒ…
11. æ£€æŸ¥å†…å®¹11: ä»»åŠ¡æ•°æ®æ±‡äº¤è®¡åˆ’

#### `tb_task_sczljdjcb` - ç”Ÿäº§è´¨é‡ç›‘ç£æ£€æŸ¥è¡¨
**åŠŸèƒ½**: å­˜å‚¨ç”Ÿäº§è¿‡ç¨‹ä¸­çš„è´¨é‡æ£€æŸ¥è®°å½•

#### `tb_task_zlpgb` - è´¨é‡è¯„ä¼°è¡¨
**åŠŸèƒ½**: å­˜å‚¨ä»»åŠ¡è´¨é‡è¯„ä¼°ä¿¡æ¯

---

### 3. åŸºç¡€ä¿¡æ¯è¡¨

#### `tb_base_master` - åŸºæœ¬äººå‘˜ä¿¡æ¯è¡¨
**åŠŸèƒ½**: å­˜å‚¨é¡¹ç›®ç›¸å…³äººå‘˜çš„åŸºæœ¬ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|--------|------|------|------|
| `id_card_number` | VARCHAR(45) | èº«ä»½è¯å· | ä¸»é”® |
| `name` | VARCHAR(100) | å§“å | - |
| `sex` | VARCHAR(10) | æ€§åˆ« | - |
| `birth_date` | DATE | å‡ºç”Ÿæ—¥æœŸ | - |
| `education` | VARCHAR(100) | å­¦å† | - |
| `major` | VARCHAR(100) | ä¸“ä¸š | - |
| `work_unit` | VARCHAR(200) | å·¥ä½œå•ä½ | - |
| `job_title` | VARCHAR(100) | èŒç§° | - |
| `phone_number` | VARCHAR(45) | ç”µè¯ | - |
| `email` | VARCHAR(100) | é‚®ç®± | - |
| `address` | VARCHAR(255) | åœ°å€ | - |
| **`user_id`** | **INT** | **åˆ›å»ºç”¨æˆ·ID** | **é»˜è®¤3** |

#### `tb_base_hq_investigator` - èˆªå‰è°ƒæŸ¥äººå‘˜è¡¨
**åŠŸèƒ½**: å­˜å‚¨èˆªå‰è°ƒæŸ¥äººå‘˜ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `uniqueid` | VARCHAR(100) | å”¯ä¸€IDï¼ˆä¸»é”®ï¼‰ |
| `task_name` | VARCHAR(100) | ä»»åŠ¡åç§° |
| `task_code` | VARCHAR(100) | ä»»åŠ¡ç¼–å· |
| `ship` | VARCHAR(100) | è°ƒæŸ¥èˆ¹ |
| `name` | VARCHAR(40) | å§“å |
| `sex` | VARCHAR(4) | æ€§åˆ« |
| `birthday` | DATE | å‡ºç”Ÿæ—¥æœŸ |
| `title` | VARCHAR(40) | èŒç§° |
| `organization` | VARCHAR(45) | æ‰€å±å•ä½ |
| `major` | VARCHAR(45) | ä¸“ä¸š |
| `instrument` | VARCHAR(45) | ä»ªå™¨è®¾å¤‡ |
| `trainingdate` | VARCHAR(45) | åŸ¹è®­æ—¥æœŸ |
| `remark` | VARCHAR(100) | å¤‡æ³¨ |
| `preparer` | VARCHAR(45) | ç¼–åˆ¶äºº |
| `verifier` | VARCHAR(45) | å®¡æ ¸äºº |
| `create_date` | DATE | åˆ›å»ºæ—¥æœŸ |
| `attachment` | TEXT | é™„ä»¶ |

#### `tb_base_hz_investigator` - èˆªä¸­è°ƒæŸ¥äººå‘˜è¡¨
**åŠŸèƒ½**: å­˜å‚¨èˆªä¸­è°ƒæŸ¥äººå‘˜ä¿¡æ¯ï¼ˆç»“æ„åŒ `tb_base_hq_investigator`ï¼‰

#### `tb_base_hq_device` - èˆªå‰è®¾å¤‡è¡¨
**åŠŸèƒ½**: å­˜å‚¨èˆªå‰ä½¿ç”¨çš„è®¾å¤‡ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `uniqueid` | VARCHAR(100) | å”¯ä¸€IDï¼ˆä¸»é”®ï¼‰ |
| `task_name` | VARCHAR(100) | ä»»åŠ¡åç§° |
| `type` | VARCHAR(45) | è®¾å¤‡ç±»å‹ |
| `name` | VARCHAR(100) | è®¾å¤‡åç§° |
| `id` | VARCHAR(45) | è®¾å¤‡ç¼–å· |
| `model` | VARCHAR(45) | å‹å· |
| `traceability` | VARCHAR(45) | æº¯æºæ€§ |
| `checkdate` | DATE | æ£€å®šæ—¥æœŸ |
| `certificate_number` | VARCHAR(45) | è¯ä¹¦ç¼–å· |
| `validity` | VARCHAR(45) | æœ‰æ•ˆæœŸ |
| `verification_institutions` | VARCHAR(45) | æ£€å®šæœºæ„ |
| `remark` | VARCHAR(100) | å¤‡æ³¨ |
| `attachment` | TEXT | é™„ä»¶ |
| `preparer` | VARCHAR(45) | ç¼–åˆ¶äºº |
| `verifier` | VARCHAR(45) | å®¡æ ¸äºº |
| `create_date` | DATE | åˆ›å»ºæ—¥æœŸ |

#### `tb_base_hz_device` - èˆªä¸­è®¾å¤‡è¡¨
**åŠŸèƒ½**: å­˜å‚¨èˆªä¸­ä½¿ç”¨çš„è®¾å¤‡ä¿¡æ¯ï¼ˆç»“æ„åŒ `tb_base_hq_device`ï¼‰

---

## ğŸ”‘ ç”¨æˆ·éš”ç¦»æœºåˆ¶

### æ ¸å¿ƒå­—æ®µ
ä»¥ä¸‹è¡¨åŒ…å« `user_id` å­—æ®µï¼Œå®ç°ç”¨æˆ·éš”ç¦»ï¼š
- âœ… `tb_task_info`
- âœ… `tb_task_hqzljdjcjlb`
- âœ… `tb_base_master`

### éš”ç¦»é€»è¾‘
1. **ç”¨æˆ·ç™»å½•**ï¼šè¿”å› `user.id`
2. **æŸ¥è¯¢æ•°æ®**ï¼šæ ¹æ® `user_id` è¿‡æ»¤ï¼ˆ`WHERE user_id = ?`ï¼‰
3. **åˆ›å»ºæ•°æ®**ï¼šè‡ªåŠ¨å…³è”å½“å‰ç”¨æˆ·çš„ `user_id`
4. **ç¦æ­¢ä¿®æ”¹**ï¼š`user_id` å­—æ®µä¸å¯ç¼–è¾‘

### ç°æœ‰æ•°æ®
- æ‰€æœ‰ç°æœ‰ä»»åŠ¡/æ£€æŸ¥è®°å½•/äººå‘˜ä¿¡æ¯ï¼š`user_id = 3`
- ç”¨æˆ·ID=3 å¯¹åº”ç”¨æˆ·åï¼š`123`

---

## ğŸ—‚ï¸ è¡¨å…³ç³»è¯´æ˜

### ä¸»è¦å…³è”
1. **ä»»åŠ¡ â†” æ£€æŸ¥è®°å½•**ï¼ˆä¸€å¯¹ä¸€ï¼‰
   - `tb_task_info.task_name` â†’ `tb_task_hqzljdjcjlb.task_name`

2. **ä»»åŠ¡ â†” äººå‘˜**ï¼ˆä¸€å¯¹å¤šï¼‰
   - `tb_task_info.task_name` â†’ `tb_base_hq_investigator.task_name`
   - `tb_task_info.task_name` â†’ `tb_base_hz_investigator.task_name`

3. **ä»»åŠ¡ â†” è®¾å¤‡**ï¼ˆä¸€å¯¹å¤šï¼‰
   - `tb_task_info.task_name` â†’ `tb_base_hq_device.task_name`
   - `tb_task_info.task_name` â†’ `tb_base_hz_device.task_name`

4. **ç”¨æˆ· â†” ä»»åŠ¡**ï¼ˆä¸€å¯¹å¤šï¼‰
   - `tb_user.id` â†’ `tb_task_info.user_id`

---

## ğŸ“¥ å¦‚ä½•ä½¿ç”¨ SQL æ–‡ä»¶

### 1. å®Œæ•´å¯¼å…¥ï¼ˆå…¨æ–°æ•°æ®åº“ï¼‰
```bash
mysql -u root -p
CREATE DATABASE marine_survey_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
exit

mysql -u root -p marine_survey_db < marine_survey_db_latest.sql
```

### 2. æ›´æ–°ç°æœ‰æ•°æ®åº“
```bash
# å¤‡ä»½ç°æœ‰æ•°æ®åº“
mysqldump -u root -p marine_survey_db > backup_old.sql

# å¯¼å…¥æ–°ç»“æ„å’Œæ•°æ®
mysql -u root -p marine_survey_db < marine_survey_db_latest.sql
```

### 3. ä½¿ç”¨ Python å¯¼å…¥
```python
import pymysql
import os

conn = pymysql.connect(
    host='localhost',
    user='root',
    password='your_password',
    database='marine_survey_db'
)

with open('marine_survey_db_latest.sql', 'r', encoding='utf-8') as f:
    sql_commands = f.read().split(';')
    
cur = conn.cursor()
for command in sql_commands:
    if command.strip():
        cur.execute(command)

conn.commit()
cur.close()
conn.close()
```

---

## ğŸ”„ æ•°æ®è¿ç§»æ£€æŸ¥æ¸…å•

### å¯¼å…¥å‰æ£€æŸ¥
- [ ] å¤‡ä»½ç°æœ‰æ•°æ®åº“
- [ ] ç¡®è®¤ MySQL ç‰ˆæœ¬å…¼å®¹ï¼ˆæ¨è 8.0+ï¼‰
- [ ] ç¡®è®¤å­—ç¬¦é›†ä¸º `utf8mb4`

### å¯¼å…¥åéªŒè¯
- [ ] æ£€æŸ¥è¡¨æ•°é‡ï¼ˆåº”ä¸º 10 å¼ è¡¨ï¼‰
- [ ] éªŒè¯ `tb_user` è¡¨æœ‰è‡ªå¢ä¸»é”® `id`
- [ ] éªŒè¯ `tb_task_info` ç­‰è¡¨æœ‰ `user_id` å­—æ®µ
- [ ] æ£€æŸ¥åˆå§‹ç”¨æˆ·æ•°æ®ï¼ˆè‡³å°‘ 4 ä¸ªç”¨æˆ·ï¼‰
- [ ] éªŒè¯ä»»åŠ¡æ•°æ®çš„ `user_id` é»˜è®¤å€¼

### SQL éªŒè¯æŸ¥è¯¢
```sql
-- æ£€æŸ¥è¡¨æ•°é‡
SELECT COUNT(*) FROM information_schema.tables 
WHERE table_schema = 'marine_survey_db';

-- æ£€æŸ¥ tb_user ç»“æ„
DESCRIBE tb_user;

-- æ£€æŸ¥ç”¨æˆ·æ•°æ®
SELECT id, name, role FROM tb_user;

-- æ£€æŸ¥ä»»åŠ¡çš„ user_id
SELECT task_name, user_id FROM tb_task_info;

-- æ£€æŸ¥æ£€æŸ¥è®°å½•çš„ user_id
SELECT task_name, user_id FROM tb_task_hqzljdjcjlb;
```

---

## ğŸ“ é‡è¦æ³¨æ„äº‹é¡¹

### 1. ä¸»é”®å˜æ›´
- âš ï¸ `tb_user` çš„ä¸»é”®ä» `name` æ”¹ä¸º `id`
- âš ï¸ `name` å­—æ®µç°åœ¨æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œä¸å†æ˜¯ä¸»é”®
- âš ï¸ æ‰€æœ‰é€šè¿‡ `name` æŸ¥è¯¢ç”¨æˆ·çš„ä»£ç éœ€è¦æ›´æ–°

### 2. ç”¨æˆ·éš”ç¦»
- âœ… `user_id` å­—æ®µå·²æ·»åŠ åˆ°å…³é”®è¡¨
- âœ… ç°æœ‰æ•°æ®é»˜è®¤ `user_id=3`
- âœ… æ–°æ•°æ®è‡ªåŠ¨å…³è”å½“å‰ç™»å½•ç”¨æˆ·

### 3. æ•°æ®ä¸€è‡´æ€§
- åˆ›å»ºä»»åŠ¡æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„æ£€æŸ¥è®°å½•
- åˆ é™¤ä»»åŠ¡æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤å¯¹åº”çš„æ£€æŸ¥è®°å½•
- ä¸¤è€…çš„ `user_id` ä¿æŒä¸€è‡´

---

**æ–‡æ¡£æ›´æ–°æ—¶é—´**: 2025-09-30  
**å¯¹åº” SQL æ–‡ä»¶**: `marine_survey_db_latest.sql`  
**å¤‡æ³¨**: æ­¤ SQL æ–‡ä»¶åŒ…å«ç”¨æˆ·éš”ç¦»åŠŸèƒ½çš„å®Œæ•´æ•°æ®åº“ç»“æ„
