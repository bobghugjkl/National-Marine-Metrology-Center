# 海洋调查现场质量监督管理系统 - 启动说明

## 📋 项目结构

```
vue-manage-system/
├── backend/              # Flask 后端
│   ├── app.py           # 主应用文件
│   ├── requirements.txt # Python 依赖
│   └── README.md        # 后端文档
├── src/                 # Vue 前端
│   ├── api/            # API 接口
│   ├── views/          # 页面视图
│   └── utils/          # 工具函数
└── mysql_final.sql     # 数据库初始化脚本
```

## 🚀 快速启动

### 1. 数据库准备

确保 MySQL 已安装并运行，然后导入数据库：

```bash
# 方式1：直接导入
mysql -u root -p < mysql_final.sql

# 方式2：MySQL 命令行
mysql -u root -p
source E:\OtherProoject\vue-manage-system\mysql_final.sql
```

**数据库信息：**
- 数据库名：`marine_survey_db`
- 用户名：`root`
- 密码：`WASDijkl15963`

### 2. 后端启动（Flask）

```bash
# 进入后端目录
cd backend

# 安装 Python 依赖
pip install -r requirements.txt

# 启动后端服务
python app.py
```

后端将运行在：`http://localhost:5000`

### 3. 前端启动（Vue）

```bash
# 回到项目根目录
cd ..

# 安装依赖（首次运行）
npm install
# 或
yarn install

# 启动开发服务器
npm run dev
# 或
yarn dev
```

前端将运行在：`http://localhost:5173`（或其他端口）

## 🔧 配置说明

### 后端配置
文件：`backend/app.py`

```python
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://root:WASDijkl15963@localhost:3306/marine_survey_db'
```

### 前端配置
文件：`src/utils/request.ts`

```typescript
const service: AxiosInstance = axios.create({
    baseURL: 'http://localhost:5000/api',
    timeout: 5000
});
```

## 📊 数据库表说明

系统包含以下核心表：

1. **tb_user** - 用户表（用户管理）
2. **tb_task_info** - 任务信息表（任务管理）
3. **tb_base_master** - 基础人员表（人员管理）
4. **tb_base_hq_investigator** - 航前调查人员表
5. **tb_base_hq_device** - 航前设备表
6. **tb_task_hqzljdjcjlb** - 航前质量监督检查记录表
7. **tb_base_hz_investigator** - 航后调查人员表
8. **tb_base_hz_device** - 航后设备表
9. **tb_task_sczljdjcb** - 现场质量监督检查表
10. **tb_task_zlpgb** - 质量评估表

## 🔑 测试账号

系统默认包含以下测试用户：

| 用户名 | 登录名 | 密码 | 角色 |
|--------|--------|------|------|
| admin | admin | 123456 | 管理员 |
| 张三 | zhangsan | 123456 | 普通用户 |
| 李四 | lisi | 123456 | 普通用户 |
| 王五 | wangwu | 123456 | 部门经理 |

## 🔍 API 测试

后端启动后，可以通过以下方式测试：

```bash
# 健康检查
curl http://localhost:5000/api/health

# 获取用户列表
curl http://localhost:5000/api/users

# 获取任务列表
curl http://localhost:5000/api/tasks

# 获取基础人员列表
curl http://localhost:5000/api/masters
```

## ⚙️ 功能说明

### 前端功能
- ✅ 用户管理（增删改查）
- ✅ 任务管理（增删改查）
- ✅ 基础人员管理（增删改查）
- ✅ 数据表格展示
- ✅ 跨域请求支持

### 后端功能
- ✅ RESTful API 接口
- ✅ MySQL 数据库连接
- ✅ CORS 跨域支持
- ✅ 完整的增删改查操作
- ✅ 错误处理机制

## 🛠️ 技术栈

**前端：**
- Vue 3
- Vite
- TypeScript
- Element Plus
- Axios

**后端：**
- Flask 3.0
- Flask-SQLAlchemy
- Flask-CORS
- PyMySQL

**数据库：**
- MySQL 8.0

## 📝 常见问题

### 1. 后端无法连接数据库
检查 MySQL 服务是否启动，密码是否正确。

### 2. 前端请求跨域错误
确保后端已启动 CORS 支持（已在 app.py 中配置）。

### 3. 前端无法访问后端
检查后端地址配置：`src/utils/request.ts` 中的 `baseURL`。

### 4. Python 依赖安装失败
尝试使用国内镜像源：
```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

## 📞 开发者

如有问题，请检查：
1. MySQL 服务是否运行
2. 数据库是否已导入
3. Python 和 Node.js 版本是否兼容
4. 端口 5000 和 5173 是否被占用
