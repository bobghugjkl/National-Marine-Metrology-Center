# å¢åˆ æ”¹æŸ¥å®ç°åŸç†è¯¦è§£ï¼ˆå°ç™½ç‰ˆï¼‰

## ğŸ“š ç›®å½•
1. [æ•´ä½“æ¶æ„](#æ•´ä½“æ¶æ„)
2. [å‰ç«¯éƒ¨åˆ†](#å‰ç«¯éƒ¨åˆ†)
3. [åç«¯éƒ¨åˆ†](#åç«¯éƒ¨åˆ†)
4. [æ•°æ®åº“éƒ¨åˆ†](#æ•°æ®åº“éƒ¨åˆ†)
5. [å®Œæ•´æµç¨‹ç¤ºä¾‹](#å®Œæ•´æµç¨‹ç¤ºä¾‹)

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå°±åƒä¸€å®¶é¤å…ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯      â”‚ â†â”€â”€â†’ â”‚   åç«¯      â”‚ â†â”€â”€â†’ â”‚  æ•°æ®åº“     â”‚
â”‚  (Vue.js)   â”‚      â”‚  (Flask)    â”‚      â”‚  (MySQL)    â”‚
â”‚  é¡¾å®¢ç‚¹èœ   â”‚      â”‚   å¨å¸ˆ      â”‚      â”‚   ä»“åº“      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **å‰ç«¯ï¼ˆVue.jsï¼‰**ï¼šå°±åƒé¤å…çš„èœå•å’ŒæœåŠ¡å‘˜ï¼Œé¡¾å®¢ï¼ˆç”¨æˆ·ï¼‰é€šè¿‡å®ƒæ¥ç‚¹èœï¼ˆæ“ä½œï¼‰
- **åç«¯ï¼ˆFlaskï¼‰**ï¼šå°±åƒå¨å¸ˆï¼Œæ¥æ”¶è®¢å•ï¼Œå¤„ç†é£Ÿæï¼Œåšå‡ºèœå“
- **æ•°æ®åº“ï¼ˆMySQLï¼‰**ï¼šå°±åƒä»“åº“ï¼Œå­˜æ”¾æ‰€æœ‰çš„é£Ÿæï¼ˆæ•°æ®ï¼‰

---

## ğŸ¨ å‰ç«¯éƒ¨åˆ†

### 1. é¡µé¢æ–‡ä»¶ï¼š`src/views/system/user.vue`

è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ç”¨æˆ·çœ‹åˆ°çš„"ç”¨æˆ·ç®¡ç†"é¡µé¢ã€‚

#### 1.1 æ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨ï¼ˆæŸ¥ï¼‰

```typescript
// ğŸ“¦ å­˜å‚¨ç”¨æˆ·æ•°æ®çš„å®¹å™¨
const tableData = ref<User[]>([]);  // å°±åƒä¸€ä¸ªç©ºç›’å­ï¼Œç­‰ç€è£…ç”¨æˆ·ä¿¡æ¯

// ğŸ“¡ ä»åç«¯è·å–æ•°æ®çš„å‡½æ•°
const getData = async () => {
    const res = await fetchUserData()  // å‘åç«¯è¦æ•°æ®
    tableData.value = res.data.data.list;  // æŠŠæ•°æ®æ”¾è¿›ç›’å­
    page.total = res.data.data.pageTotal;  // è®°å½•æ€»å…±æœ‰å¤šå°‘ä¸ªç”¨æˆ·
};

// ğŸš€ é¡µé¢åŠ è½½æ—¶å°±è·å–æ•°æ®
getData();
```

**è§£é‡Šï¼š**
1. `tableData` æ˜¯ä¸€ä¸ª"å˜é‡"ï¼Œç”¨æ¥å­˜æ”¾ç”¨æˆ·åˆ—è¡¨
2. `getData()` æ˜¯ä¸€ä¸ª"å‡½æ•°"ï¼Œå®ƒçš„å·¥ä½œæ˜¯ï¼š
   - è°ƒç”¨ `fetchUserData()`ï¼ˆå‘åç«¯å‘è¯·æ±‚ï¼‰
   - ç­‰å¾…åç«¯è¿”å›æ•°æ®
   - æŠŠæ•°æ®å­˜åˆ° `tableData` é‡Œ
3. é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œ `getData()`ï¼Œæ‰€ä»¥ä¸€æ‰“å¼€é¡µé¢å°±èƒ½çœ‹åˆ°ç”¨æˆ·åˆ—è¡¨

#### 1.2 æ–°å¢ç”¨æˆ·

```typescript
// ğŸ“ æ–°å¢/ç¼–è¾‘çš„å¤„ç†å‡½æ•°
const updateData = async (formData: any) => {
    try {
        if (isEdit.value) {
            // å¦‚æœæ˜¯ç¼–è¾‘æ¨¡å¼ï¼ˆç•¥è¿‡ï¼‰
        } else {
            // ğŸ†• æ–°å¢æ¨¡å¼
            await createUser(formData);  // è°ƒç”¨åç«¯çš„åˆ›å»ºæ¥å£
            ElMessage.success('åˆ›å»ºæˆåŠŸ');  // æ˜¾ç¤ºæˆåŠŸæç¤º
        }
        closeDialog();  // å…³é—­å¯¹è¯æ¡†
        getData();      // é‡æ–°è·å–åˆ—è¡¨ï¼ˆåˆ·æ–°é¡µé¢ï¼‰
    } catch (error: any) {
        ElMessage.error('æ“ä½œå¤±è´¥');  // æ˜¾ç¤ºé”™è¯¯æç¤º
    }
};
```

**æµç¨‹ï¼š**
1. ç”¨æˆ·ç‚¹å‡»"æ–°å¢"æŒ‰é’® â†’ å¼¹å‡ºè¡¨å•
2. ç”¨æˆ·å¡«å†™ä¿¡æ¯ï¼ˆç”¨æˆ·åã€å¯†ç ç­‰ï¼‰
3. ç”¨æˆ·ç‚¹å‡»"ä¿å­˜" â†’ è°ƒç”¨ `updateData()`
4. `updateData()` è°ƒç”¨ `createUser()` â†’ å‘é€æ•°æ®åˆ°åç«¯
5. åç«¯ä¿å­˜æˆåŠŸ â†’ å‰ç«¯æ˜¾ç¤º"åˆ›å»ºæˆåŠŸ"
6. è°ƒç”¨ `getData()` â†’ åˆ·æ–°åˆ—è¡¨ï¼Œæ–°ç”¨æˆ·å°±å‡ºç°äº†

#### 1.3 ç¼–è¾‘ç”¨æˆ·

```typescript
// âœï¸ ç‚¹å‡»ç¼–è¾‘æŒ‰é’®æ—¶
const handleEdit = (row: User) => {
    rowData.value = { ...row };  // æŠŠå½“å‰ç”¨æˆ·çš„æ•°æ®å¤åˆ¶åˆ°è¡¨å•
    isEdit.value = true;         // æ ‡è®°ä¸º"ç¼–è¾‘æ¨¡å¼"
    visible.value = true;        // æ˜¾ç¤ºå¯¹è¯æ¡†
};

// ğŸ’¾ ä¿å­˜ç¼–è¾‘
const updateData = async (formData: any) => {
    try {
        if (isEdit.value) {
            // âœï¸ ç¼–è¾‘æ¨¡å¼
            await updateUser(formData.name, formData);  // è°ƒç”¨æ›´æ–°æ¥å£
            ElMessage.success('æ›´æ–°æˆåŠŸ');
        }
        closeDialog();
        getData();  // åˆ·æ–°åˆ—è¡¨
    } catch (error: any) {
        ElMessage.error('æ“ä½œå¤±è´¥');
    }
};
```

**æµç¨‹ï¼š**
1. ç”¨æˆ·ç‚¹å‡»æŸä¸€è¡Œçš„"ç¼–è¾‘"æŒ‰é’®
2. `handleEdit()` è¢«è°ƒç”¨ï¼ŒæŠŠè¿™ä¸€è¡Œçš„æ•°æ®å¡«åˆ°è¡¨å•é‡Œ
3. ç”¨æˆ·ä¿®æ”¹ä¿¡æ¯
4. ç”¨æˆ·ç‚¹å‡»"ä¿å­˜" â†’ è°ƒç”¨ `updateData()`
5. å› ä¸º `isEdit.value = true`ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨ `updateUser()`
6. åç«¯æ›´æ–°æˆåŠŸ â†’ å‰ç«¯åˆ·æ–°åˆ—è¡¨

#### 1.4 åˆ é™¤ç”¨æˆ·

```typescript
// ğŸ—‘ï¸ åˆ é™¤ç”¨æˆ·
const handleDelete = async (row: User) => {
    try {
        // å…ˆå¼¹å‡ºç¡®è®¤æ¡†
        await ElMessageBox.confirm('ç¡®å®šè¦åˆ é™¤è¯¥ç”¨æˆ·å—ï¼Ÿ', 'æç¤º', {
            confirmButtonText: 'ç¡®å®š',
            cancelButtonText: 'å–æ¶ˆ',
            type: 'warning'
        });
        
        // ç”¨æˆ·ç‚¹å‡»"ç¡®å®š"åæ‰æ‰§è¡Œåˆ é™¤
        await deleteUser(row.name);  // è°ƒç”¨åˆ é™¤æ¥å£
        ElMessage.success('åˆ é™¤æˆåŠŸ');
        getData();  // åˆ·æ–°åˆ—è¡¨
    } catch (error: any) {
        if (error !== 'cancel') {
            ElMessage.error('åˆ é™¤å¤±è´¥');
        }
    }
};
```

**æµç¨‹ï¼š**
1. ç”¨æˆ·ç‚¹å‡»"åˆ é™¤"æŒ‰é’®
2. å¼¹å‡ºç¡®è®¤æ¡†ï¼š"ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ"
3. ç”¨æˆ·ç‚¹å‡»"ç¡®å®š" â†’ è°ƒç”¨ `deleteUser()`
4. åç«¯åˆ é™¤æˆåŠŸ â†’ å‰ç«¯åˆ·æ–°åˆ—è¡¨ï¼Œç”¨æˆ·æ¶ˆå¤±äº†

### 2. API æ–‡ä»¶ï¼š`src/api/index.ts`

è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†å¦‚ä½•å’Œåç«¯é€šä¿¡ã€‚

```typescript
import request from '../utils/request';  // å¼•å…¥å·¥å…·

// ğŸ“¡ è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆGET è¯·æ±‚ï¼‰
export const fetchUserData = () => {
    return request({
        url: '/users',      // è®¿é—®åœ°å€ï¼š/api/users
        method: 'get'       // æ–¹æ³•ï¼šGETï¼ˆè·å–ï¼‰
    });
};

// ğŸ†• åˆ›å»ºç”¨æˆ·ï¼ˆPOST è¯·æ±‚ï¼‰
export const createUser = (data: any) => {
    return request({
        url: '/users',      // è®¿é—®åœ°å€ï¼š/api/users
        method: 'post',     // æ–¹æ³•ï¼šPOSTï¼ˆåˆ›å»ºï¼‰
        data                // å‘é€çš„æ•°æ®ï¼ˆç”¨æˆ·ä¿¡æ¯ï¼‰
    });
};

// âœï¸ æ›´æ–°ç”¨æˆ·ï¼ˆPUT è¯·æ±‚ï¼‰
export const updateUser = (name: string, data: any) => {
    return request({
        url: `/users/${encodeURIComponent(name)}`,  // åœ°å€ï¼š/api/users/admin
        method: 'put',      // æ–¹æ³•ï¼šPUTï¼ˆæ›´æ–°ï¼‰
        data                // å‘é€çš„æ•°æ®ï¼ˆæ–°ä¿¡æ¯ï¼‰
    });
};

// ğŸ—‘ï¸ åˆ é™¤ç”¨æˆ·ï¼ˆDELETE è¯·æ±‚ï¼‰
export const deleteUser = (name: string) => {
    return request({
        url: `/users/${encodeURIComponent(name)}`,  // åœ°å€ï¼š/api/users/admin
        method: 'delete'    // æ–¹æ³•ï¼šDELETEï¼ˆåˆ é™¤ï¼‰
    });
};
```

**è§£é‡Šï¼š**
- **GET**ï¼šè·å–æ•°æ®ï¼ˆå°±åƒ"æŸ¥çœ‹èœå•"ï¼‰
- **POST**ï¼šåˆ›å»ºæ•°æ®ï¼ˆå°±åƒ"ä¸‹æ–°è®¢å•"ï¼‰
- **PUT**ï¼šæ›´æ–°æ•°æ®ï¼ˆå°±åƒ"ä¿®æ”¹è®¢å•"ï¼‰
- **DELETE**ï¼šåˆ é™¤æ•°æ®ï¼ˆå°±åƒ"å–æ¶ˆè®¢å•"ï¼‰

- `encodeURIComponent(name)`ï¼šæŠŠä¸­æ–‡æˆ–ç‰¹æ®Šå­—ç¬¦è½¬æ¢æˆ URL å®‰å…¨çš„æ ¼å¼
  - ä¾‹å¦‚ï¼š`"å¼ ä¸‰"` â†’ `"%E5%BC%A0%E4%B8%89"`

### 3. è¯·æ±‚é…ç½®ï¼š`src/utils/request.ts`

```typescript
import axios from 'axios';

const service = axios.create({
    baseURL: 'http://localhost:5000/api',  // åç«¯åœ°å€
    timeout: 5000  // è¶…æ—¶æ—¶é—´ï¼š5ç§’
});

export default service;
```

**è§£é‡Šï¼š**
- `baseURL`ï¼šåç«¯çš„åŸºç¡€åœ°å€
- å½“è°ƒç”¨ `/users` æ—¶ï¼Œå®é™…è®¿é—®çš„æ˜¯ `http://localhost:5000/api/users`

---

## ğŸ”§ åç«¯éƒ¨åˆ†

### 1. ä¸»æ–‡ä»¶ï¼š`backend/app.py`

åç«¯å°±åƒä¸€ä¸ª"æœåŠ¡å‘˜"ï¼Œæ¥æ”¶å‰ç«¯çš„è¯·æ±‚ï¼Œæ“ä½œæ•°æ®åº“ï¼Œç„¶åè¿”å›ç»“æœã€‚

#### 1.1 æ•°æ®åº“è¿æ¥

```python
from flask import Flask, request, jsonify
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)

# ğŸ”— è¿æ¥æ•°æ®åº“ï¼ˆå°±åƒè¿æ¥ä»“åº“ï¼‰
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://root:å¯†ç @localhost:3306/marine_survey_db'

db = SQLAlchemy(app)  # åˆ›å»ºæ•°æ®åº“æ“ä½œå¯¹è±¡
```

**è§£é‡Šï¼š**
- `mysql+pymysql://`ï¼šä½¿ç”¨ MySQL æ•°æ®åº“
- `root:å¯†ç `ï¼šæ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç 
- `localhost:3306`ï¼šæ•°æ®åº“çš„åœ°å€å’Œç«¯å£
- `marine_survey_db`ï¼šæ•°æ®åº“åç§°

#### 1.2 å®šä¹‰æ•°æ®æ¨¡å‹

```python
# ğŸ‘¤ ç”¨æˆ·æ¨¡å‹ï¼ˆå¯¹åº”æ•°æ®åº“çš„ tb_user è¡¨ï¼‰
class User(db.Model):
    __tablename__ = 'tb_user'  # è¡¨å
    
    # å®šä¹‰å­—æ®µï¼ˆå°±åƒè¡¨æ ¼çš„åˆ—ï¼‰
    name = db.Column(db.String(45), primary_key=True)  # ç”¨æˆ·åï¼ˆä¸»é”®ï¼‰
    login_name = db.Column(db.String(45))  # ç™»å½•å
    password = db.Column(db.String(45))    # å¯†ç 
    sex = db.Column(db.String(45))         # æ€§åˆ«
    role = db.Column(db.String(45))        # è§’è‰²
    department = db.Column(db.String(255)) # éƒ¨é—¨
    
    # ğŸ“¦ è½¬æ¢æˆå­—å…¸ï¼ˆæ–¹ä¾¿è¿”å›ç»™å‰ç«¯ï¼‰
    def to_dict(self):
        return {
            'name': self.name,
            'login_name': self.login_name,
            'password': self.password,
            'sex': self.sex,
            'role': self.role,
            'department': self.department
        }
```

**è§£é‡Šï¼š**
- `User` ç±»å¯¹åº”æ•°æ®åº“çš„ `tb_user` è¡¨
- æ¯ä¸ªå±æ€§å¯¹åº”è¡¨çš„ä¸€åˆ—
- `to_dict()` æ–¹æ³•æŠŠå¯¹è±¡è½¬æ¢æˆå­—å…¸ï¼Œæ–¹ä¾¿ä»¥ JSON æ ¼å¼è¿”å›

#### 1.3 æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ï¼ˆGETï¼‰

```python
@app.route('/api/users', methods=['GET'])
def get_users():
    try:
        # ğŸ“š ä»æ•°æ®åº“è·å–æ‰€æœ‰ç”¨æˆ·
        users = User.query.all()  # å°±åƒï¼šSELECT * FROM tb_user
        
        # ğŸ“¦ è½¬æ¢æˆåˆ—è¡¨
        user_list = [u.to_dict() for u in users]
        
        # ğŸ“¤ è¿”å›ç»™å‰ç«¯
        return jsonify({
            'code': 200,
            'data': {
                'list': user_list,
                'pageTotal': len(user_list)
            }
        })
    except Exception as e:
        return jsonify({'code': 500, 'message': str(e)}), 500
```

**æµç¨‹ï¼š**
1. å‰ç«¯å‘é€ GET è¯·æ±‚åˆ° `/api/users`
2. åç«¯è°ƒç”¨ `User.query.all()` ä»æ•°æ®åº“è·å–æ‰€æœ‰ç”¨æˆ·
3. æŠŠæ¯ä¸ªç”¨æˆ·å¯¹è±¡è½¬æ¢æˆå­—å…¸
4. è¿”å› JSON æ ¼å¼çš„æ•°æ®ç»™å‰ç«¯

**è¿”å›çš„æ•°æ®æ ¼å¼ï¼š**
```json
{
  "code": 200,
  "data": {
    "list": [
      {"name": "admin", "role": "ç®¡ç†å‘˜", ...},
      {"name": "å¼ ä¸‰", "role": "æ™®é€šç”¨æˆ·", ...}
    ],
    "pageTotal": 2
  }
}
```

#### 1.4 åˆ›å»ºç”¨æˆ·ï¼ˆPOSTï¼‰

```python
@app.route('/api/users', methods=['POST'])
def create_user():
    try:
        # ğŸ“¥ æ¥æ”¶å‰ç«¯å‘é€çš„æ•°æ®
        data = request.json  # è·å– JSON æ•°æ®
        
        # ğŸ†• åˆ›å»ºæ–°ç”¨æˆ·å¯¹è±¡
        user = User(
            name=data['name'],
            login_name=data.get('login_name'),
            password=data.get('password'),
            sex=data.get('sex'),
            role=data.get('role'),
            department=data.get('department')
        )
        
        # ğŸ’¾ ä¿å­˜åˆ°æ•°æ®åº“
        db.session.add(user)      # æ·»åŠ åˆ°ä¼šè¯
        db.session.commit()       # æäº¤ï¼ˆçœŸæ­£ä¿å­˜ï¼‰
        
        # ğŸ“¤ è¿”å›æˆåŠŸæ¶ˆæ¯
        return jsonify({
            'code': 200, 
            'message': 'åˆ›å»ºæˆåŠŸ', 
            'data': user.to_dict()
        })
    except Exception as e:
        db.session.rollback()  # å‡ºé”™å°±å›æ»šï¼ˆæ’¤é”€ï¼‰
        return jsonify({'code': 500, 'message': str(e)}), 500
```

**æµç¨‹ï¼š**
1. å‰ç«¯å‘é€ POST è¯·æ±‚ï¼Œå¸¦ä¸Šç”¨æˆ·æ•°æ®
2. åç«¯æ¥æ”¶æ•°æ®ï¼š`request.json`
3. åˆ›å»º `User` å¯¹è±¡
4. è°ƒç”¨ `db.session.add()` æ·»åŠ åˆ°æ•°æ®åº“
5. è°ƒç”¨ `db.session.commit()` æäº¤ä¿å­˜
6. è¿”å›æˆåŠŸæ¶ˆæ¯

**SQL ç­‰ä»·ï¼š**
```sql
INSERT INTO tb_user (name, login_name, password, role, department) 
VALUES ('æ–°ç”¨æˆ·', 'newuser', '123456', 'æ™®é€šç”¨æˆ·', 'æŠ€æœ¯éƒ¨');
```

#### 1.5 æ›´æ–°ç”¨æˆ·ï¼ˆPUTï¼‰

```python
@app.route('/api/users/<name>', methods=['PUT'])
def update_user(name):
    try:
        # ğŸ” æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·
        user = User.query.filter_by(name=name).first()
        
        if not user:
            return jsonify({'code': 404, 'message': 'ç”¨æˆ·ä¸å­˜åœ¨'}), 404
        
        # ğŸ“ è·å–è¦æ›´æ–°çš„æ•°æ®
        data = request.json
        
        # âœï¸ æ›´æ–°å­—æ®µ
        for key, value in data.items():
            if hasattr(user, key):  # å¦‚æœç”¨æˆ·å¯¹è±¡æœ‰è¿™ä¸ªå±æ€§
                setattr(user, key, value)  # å°±æ›´æ–°å®ƒ
        
        # ğŸ’¾ ä¿å­˜åˆ°æ•°æ®åº“
        db.session.commit()
        
        # ğŸ“¤ è¿”å›æˆåŠŸæ¶ˆæ¯
        return jsonify({
            'code': 200, 
            'message': 'æ›´æ–°æˆåŠŸ', 
            'data': user.to_dict()
        })
    except Exception as e:
        db.session.rollback()
        return jsonify({'code': 500, 'message': str(e)}), 500
```

**æµç¨‹ï¼š**
1. å‰ç«¯å‘é€ PUT è¯·æ±‚åˆ° `/api/users/admin`ï¼Œå¸¦ä¸Šæ–°æ•°æ®
2. åç«¯ä» URL ä¸­æå–ç”¨æˆ·å `admin`
3. æŸ¥æ‰¾è¿™ä¸ªç”¨æˆ·ï¼š`User.query.filter_by(name='admin').first()`
4. æ›´æ–°ç”¨æˆ·çš„å±æ€§
5. æäº¤ä¿å­˜
6. è¿”å›æˆåŠŸæ¶ˆæ¯

**SQL ç­‰ä»·ï¼š**
```sql
UPDATE tb_user 
SET role='super_admin', department='ITéƒ¨é—¨' 
WHERE name='admin';
```

#### 1.6 åˆ é™¤ç”¨æˆ·ï¼ˆDELETEï¼‰

```python
@app.route('/api/users/<name>', methods=['DELETE'])
def delete_user(name):
    try:
        # ğŸ” æŸ¥æ‰¾ç”¨æˆ·
        user = User.query.filter_by(name=name).first()
        
        if not user:
            return jsonify({'code': 404, 'message': 'ç”¨æˆ·ä¸å­˜åœ¨'}), 404
        
        # ğŸ—‘ï¸ åˆ é™¤ç”¨æˆ·
        db.session.delete(user)
        db.session.commit()
        
        # ğŸ“¤ è¿”å›æˆåŠŸæ¶ˆæ¯
        return jsonify({'code': 200, 'message': 'åˆ é™¤æˆåŠŸ'})
    except Exception as e:
        db.session.rollback()
        return jsonify({'code': 500, 'message': str(e)}), 500
```

**æµç¨‹ï¼š**
1. å‰ç«¯å‘é€ DELETE è¯·æ±‚åˆ° `/api/users/admin`
2. åç«¯ä» URL ä¸­æå–ç”¨æˆ·å `admin`
3. æŸ¥æ‰¾è¿™ä¸ªç”¨æˆ·
4. è°ƒç”¨ `db.session.delete()` åˆ é™¤
5. æäº¤ä¿å­˜
6. è¿”å›æˆåŠŸæ¶ˆæ¯

**SQL ç­‰ä»·ï¼š**
```sql
DELETE FROM tb_user WHERE name='admin';
```

---

## ğŸ’¾ æ•°æ®åº“éƒ¨åˆ†

### 1. æ•°æ®åº“è¡¨ç»“æ„

```sql
CREATE TABLE tb_user (
    name VARCHAR(45) PRIMARY KEY,    -- ç”¨æˆ·åï¼ˆä¸»é”®ï¼‰
    login_name VARCHAR(45),           -- ç™»å½•å
    password VARCHAR(45),             -- å¯†ç 
    sex VARCHAR(45),                  -- æ€§åˆ«
    role VARCHAR(45),                 -- è§’è‰²
    department VARCHAR(255)           -- éƒ¨é—¨
);
```

**è§£é‡Šï¼š**
- `PRIMARY KEY`ï¼šä¸»é”®ï¼Œå”¯ä¸€æ ‡è¯†æ¯ä¸€è¡Œ
- `VARCHAR(45)`ï¼šå¯å˜é•¿åº¦å­—ç¬¦ä¸²ï¼Œæœ€å¤š 45 ä¸ªå­—ç¬¦

### 2. æ•°æ®å­˜å‚¨ç¤ºä¾‹

| name | login_name | password | sex | role | department |
|------|------------|----------|-----|------|------------|
| admin | admin | 123456 | ç”· | ç®¡ç†å‘˜ | ç³»ç»Ÿç®¡ç†éƒ¨ |
| å¼ ä¸‰ | zhangsan | 123456 | ç”· | æ™®é€šç”¨æˆ· | ä¸šåŠ¡éƒ¨é—¨ |
| æå›› | lisi | 123456 | å¥³ | æ™®é€šç”¨æˆ· | ä¸šåŠ¡éƒ¨é—¨ |

---

## ğŸ”„ å®Œæ•´æµç¨‹ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨

```
1. ğŸ‘¤ ç”¨æˆ·æ‰“å¼€"ç”¨æˆ·ç®¡ç†"é¡µé¢
   â†“
2. ğŸ¨ å‰ç«¯è°ƒç”¨ getData()
   â†“
3. ğŸ“¡ å‰ç«¯è°ƒç”¨ fetchUserData()
   â†“
4. ğŸŒ å‘é€ GET è¯·æ±‚åˆ° http://localhost:5000/api/users
   â†“
5. ğŸ”§ åç«¯æ¥æ”¶è¯·æ±‚ï¼Œæ‰§è¡Œ get_users()
   â†“
6. ğŸ’¾ åç«¯æ‰§è¡Œ User.query.all()ï¼Œä»æ•°æ®åº“è·å–æ‰€æœ‰ç”¨æˆ·
   â†“
7. ğŸ“¤ åç«¯è¿”å› JSON æ•°æ®
   {
     "code": 200,
     "data": {
       "list": [...ç”¨æˆ·åˆ—è¡¨...],
       "pageTotal": 5
     }
   }
   â†“
8. ğŸ¨ å‰ç«¯æ¥æ”¶æ•°æ®ï¼Œå­˜å‚¨åˆ° tableData
   â†“
9. ğŸ“º é¡µé¢æ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨
```

### ç¤ºä¾‹ 2ï¼šæ–°å¢ç”¨æˆ·

```
1. ğŸ‘¤ ç”¨æˆ·ç‚¹å‡»"æ–°å¢"æŒ‰é’®
   â†“
2. ğŸ“ å¼¹å‡ºè¡¨å•ï¼Œç”¨æˆ·å¡«å†™ä¿¡æ¯
   {
     "name": "ç‹äº”",
     "login_name": "wangwu",
     "password": "123456",
     "role": "ç»ç†",
     "department": "é”€å”®éƒ¨"
   }
   â†“
3. ğŸ‘¤ ç”¨æˆ·ç‚¹å‡»"ä¿å­˜"æŒ‰é’®
   â†“
4. ğŸ¨ å‰ç«¯è°ƒç”¨ updateData(formData)
   â†“
5. ğŸ“¡ å‰ç«¯è°ƒç”¨ createUser(formData)
   â†“
6. ğŸŒ å‘é€ POST è¯·æ±‚åˆ° http://localhost:5000/api/users
   æºå¸¦æ•°æ®ï¼š{"name":"ç‹äº”","login_name":"wangwu",...}
   â†“
7. ğŸ”§ åç«¯æ¥æ”¶è¯·æ±‚ï¼Œæ‰§è¡Œ create_user()
   â†“
8. ğŸ’¾ åç«¯åˆ›å»º User å¯¹è±¡ï¼Œæ‰§è¡Œï¼š
   db.session.add(user)
   db.session.commit()
   
   ç­‰ä»· SQLï¼š
   INSERT INTO tb_user (name, login_name, password, role, department)
   VALUES ('ç‹äº”', 'wangwu', '123456', 'ç»ç†', 'é”€å”®éƒ¨');
   â†“
9. ğŸ“¤ åç«¯è¿”å›æˆåŠŸæ¶ˆæ¯
   {"code": 200, "message": "åˆ›å»ºæˆåŠŸ"}
   â†“
10. ğŸ¨ å‰ç«¯æ˜¾ç¤º"åˆ›å»ºæˆåŠŸ"æç¤º
   â†“
11. ğŸ”„ å‰ç«¯è°ƒç”¨ getData() åˆ·æ–°åˆ—è¡¨
   â†“
12. ğŸ“º é¡µé¢æ˜¾ç¤ºæ–°ç”¨æˆ·"ç‹äº”"
```

### ç¤ºä¾‹ 3ï¼šç¼–è¾‘ç”¨æˆ·

```
1. ğŸ‘¤ ç”¨æˆ·ç‚¹å‡»"admin"è¿™ä¸€è¡Œçš„"ç¼–è¾‘"æŒ‰é’®
   â†“
2. ğŸ¨ å‰ç«¯è°ƒç”¨ handleEdit(row)
   row = {"name":"admin","role":"ç®¡ç†å‘˜",...}
   â†“
3. ğŸ“ å¼¹å‡ºè¡¨å•ï¼Œæ˜¾ç¤ºå½“å‰æ•°æ®
   ç”¨æˆ·åï¼šadminï¼ˆç¦ç”¨ï¼Œä¸å¯ä¿®æ”¹ï¼‰
   è§’è‰²ï¼šç®¡ç†å‘˜
   éƒ¨é—¨ï¼šç³»ç»Ÿç®¡ç†éƒ¨
   â†“
4. ğŸ‘¤ ç”¨æˆ·ä¿®æ”¹è§’è‰²ä¸º"è¶…çº§ç®¡ç†å‘˜"ï¼Œç‚¹å‡»"ä¿å­˜"
   â†“
5. ğŸ¨ å‰ç«¯è°ƒç”¨ updateData(formData)
   formData = {"name":"admin","role":"è¶…çº§ç®¡ç†å‘˜",...}
   â†“
6. ğŸ“¡ å‰ç«¯è°ƒç”¨ updateUser('admin', formData)
   â†“
7. ğŸŒ å‘é€ PUT è¯·æ±‚åˆ° http://localhost:5000/api/users/admin
   æºå¸¦æ•°æ®ï¼š{"role":"è¶…çº§ç®¡ç†å‘˜",...}
   â†“
8. ğŸ”§ åç«¯æ¥æ”¶è¯·æ±‚ï¼Œæ‰§è¡Œ update_user(name='admin')
   â†“
9. ğŸ” åç«¯æŸ¥æ‰¾ç”¨æˆ·ï¼š
   user = User.query.filter_by(name='admin').first()
   â†“
10. âœï¸ åç«¯æ›´æ–°å­—æ®µï¼š
   user.role = 'è¶…çº§ç®¡ç†å‘˜'
   db.session.commit()
   
   ç­‰ä»· SQLï¼š
   UPDATE tb_user SET role='è¶…çº§ç®¡ç†å‘˜' WHERE name='admin';
   â†“
11. ğŸ“¤ åç«¯è¿”å›æˆåŠŸæ¶ˆæ¯
   {"code": 200, "message": "æ›´æ–°æˆåŠŸ"}
   â†“
12. ğŸ¨ å‰ç«¯æ˜¾ç¤º"æ›´æ–°æˆåŠŸ"æç¤º
   â†“
13. ğŸ”„ å‰ç«¯è°ƒç”¨ getData() åˆ·æ–°åˆ—è¡¨
   â†“
14. ğŸ“º é¡µé¢æ˜¾ç¤ºæ›´æ–°åçš„æ•°æ®
```

### ç¤ºä¾‹ 4ï¼šåˆ é™¤ç”¨æˆ·

```
1. ğŸ‘¤ ç”¨æˆ·ç‚¹å‡»"å¼ ä¸‰"è¿™ä¸€è¡Œçš„"åˆ é™¤"æŒ‰é’®
   â†“
2. ğŸ¨ å‰ç«¯è°ƒç”¨ handleDelete(row)
   row = {"name":"å¼ ä¸‰",...}
   â†“
3. âš ï¸ å¼¹å‡ºç¡®è®¤æ¡†ï¼š"ç¡®å®šè¦åˆ é™¤è¯¥ç”¨æˆ·å—ï¼Ÿ"
   â†“
4. ğŸ‘¤ ç”¨æˆ·ç‚¹å‡»"ç¡®å®š"
   â†“
5. ğŸ“¡ å‰ç«¯è°ƒç”¨ deleteUser('å¼ ä¸‰')
   â†“
6. ğŸŒ å‘é€ DELETE è¯·æ±‚åˆ° http://localhost:5000/api/users/å¼ ä¸‰
   ï¼ˆå®é™… URLï¼š/api/users/%E5%BC%A0%E4%B8%89ï¼‰
   â†“
7. ğŸ”§ åç«¯æ¥æ”¶è¯·æ±‚ï¼Œæ‰§è¡Œ delete_user(name='å¼ ä¸‰')
   â†“
8. ğŸ” åç«¯æŸ¥æ‰¾ç”¨æˆ·ï¼š
   user = User.query.filter_by(name='å¼ ä¸‰').first()
   â†“
9. ğŸ—‘ï¸ åç«¯åˆ é™¤ç”¨æˆ·ï¼š
   db.session.delete(user)
   db.session.commit()
   
   ç­‰ä»· SQLï¼š
   DELETE FROM tb_user WHERE name='å¼ ä¸‰';
   â†“
10. ğŸ“¤ åç«¯è¿”å›æˆåŠŸæ¶ˆæ¯
   {"code": 200, "message": "åˆ é™¤æˆåŠŸ"}
   â†“
11. ğŸ¨ å‰ç«¯æ˜¾ç¤º"åˆ é™¤æˆåŠŸ"æç¤º
   â†“
12. ğŸ”„ å‰ç«¯è°ƒç”¨ getData() åˆ·æ–°åˆ—è¡¨
   â†“
13. ğŸ“º é¡µé¢ä¸­"å¼ ä¸‰"æ¶ˆå¤±äº†
```

---

## ğŸ”‘ å…³é”®çŸ¥è¯†ç‚¹æ€»ç»“

### 1. HTTP è¯·æ±‚æ–¹æ³•

| æ–¹æ³• | ç”¨é€” | å‰ç«¯è°ƒç”¨ | åç«¯æ–¹æ³• |
|------|------|----------|----------|
| GET | æŸ¥è¯¢æ•°æ® | fetchUserData() | get_users() |
| POST | åˆ›å»ºæ•°æ® | createUser(data) | create_user() |
| PUT | æ›´æ–°æ•°æ® | updateUser(name, data) | update_user(name) |
| DELETE | åˆ é™¤æ•°æ® | deleteUser(name) | delete_user(name) |

### 2. æ•°æ®æµè½¬

```
å‰ç«¯è¡¨å•æ•°æ® â†’ JSON æ ¼å¼ â†’ HTTP è¯·æ±‚ â†’ åç«¯æ¥æ”¶ â†’ æ•°æ®åº“æ“ä½œ â†’ è¿”å›ç»“æœ â†’ å‰ç«¯æ›´æ–°ç•Œé¢
```

### 3. URL ç¼–ç 

```javascript
// ç”¨æˆ·åï¼šå¼ ä¸‰
encodeURIComponent('å¼ ä¸‰')  // ç»“æœï¼š%E5%BC%A0%E4%B8%89

// ä¸ºä»€ä¹ˆè¦ç¼–ç ï¼Ÿ
// URL ä¸­ä¸èƒ½ç›´æ¥ä½¿ç”¨ä¸­æ–‡ï¼Œéœ€è¦è½¬æ¢æˆæµè§ˆå™¨èƒ½è¯†åˆ«çš„æ ¼å¼
```

### 4. æ•°æ®åº“æ“ä½œ

```python
# æŸ¥è¯¢æ‰€æœ‰
users = User.query.all()  # SELECT * FROM tb_user

# æ¡ä»¶æŸ¥è¯¢
user = User.query.filter_by(name='admin').first()  # SELECT * FROM tb_user WHERE name='admin'

# æ·»åŠ 
db.session.add(user)  # INSERT INTO tb_user ...

# æ›´æ–°
user.role = 'new_role'
db.session.commit()  # UPDATE tb_user SET role='new_role' ...

# åˆ é™¤
db.session.delete(user)  # DELETE FROM tb_user ...
```

### 5. å¼‚æ­¥æ“ä½œ

```typescript
// async/awaitï¼šç­‰å¾…å¼‚æ­¥æ“ä½œå®Œæˆ

async function getData() {
    // awaitï¼šç­‰å¾… fetchUserData() å®Œæˆï¼Œæ‰ç»§ç»­æ‰§è¡Œ
    const res = await fetchUserData();
    
    // ä¸Šä¸€è¡Œå®Œæˆåï¼Œæ‰ä¼šæ‰§è¡Œè¿™ä¸€è¡Œ
    tableData.value = res.data.data.list;
}
```

---

## ğŸ¯ å®æˆ˜ç»ƒä¹ å»ºè®®

### ç»ƒä¹  1ï¼šæ·»åŠ æœç´¢åŠŸèƒ½
ä¿®æ”¹åç«¯ï¼Œæ”¯æŒæŒ‰ç”¨æˆ·åæœç´¢ï¼š
```python
@app.route('/api/users', methods=['GET'])
def get_users():
    name = request.args.get('name')  # è·å–æŸ¥è¯¢å‚æ•°
    if name:
        users = User.query.filter(User.name.like(f'%{name}%')).all()
    else:
        users = User.query.all()
    # ...
```

### ç»ƒä¹  2ï¼šæ·»åŠ åˆ†é¡µåŠŸèƒ½
```python
page = request.args.get('page', 1, type=int)
per_page = 10
users = User.query.paginate(page=page, per_page=per_page)
```

### ç»ƒä¹  3ï¼šæ·»åŠ å¯†ç åŠ å¯†
```python
from werkzeug.security import generate_password_hash

user.password = generate_password_hash(data['password'])
```

---

## ğŸ“š å¸¸è§é—®é¢˜

### Q1ï¼šä¸ºä»€ä¹ˆè¦åˆ†å‰ç«¯å’Œåç«¯ï¼Ÿ
**Aï¼š** 
- **èŒè´£åˆ†ç¦»**ï¼šå‰ç«¯è´Ÿè´£å±•ç¤ºï¼Œåç«¯è´Ÿè´£æ•°æ®å¤„ç†
- **å®‰å…¨æ€§**ï¼šåç«¯å¯ä»¥éªŒè¯æ•°æ®ï¼Œé˜²æ­¢æ¶æ„æ“ä½œ
- **å¯ç»´æŠ¤æ€§**ï¼šå‰ç«¯å’Œåç«¯å¯ä»¥ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²

### Q2ï¼šæ•°æ®æ˜¯æ€ä¹ˆä¼ è¾“çš„ï¼Ÿ
**Aï¼š**
1. å‰ç«¯æŠŠæ•°æ®è½¬æ¢æˆ JSON æ ¼å¼
2. é€šè¿‡ HTTP è¯·æ±‚å‘é€ç»™åç«¯
3. åç«¯è§£æ JSONï¼Œæå–æ•°æ®
4. æ“ä½œæ•°æ®åº“
5. æŠŠç»“æœè½¬æ¢æˆ JSON è¿”å›ç»™å‰ç«¯

### Q3ï¼šä¸ºä»€ä¹ˆç”¨æˆ·åä¸èƒ½ä¿®æ”¹ï¼Ÿ
**Aï¼š**
- ç”¨æˆ·åæ˜¯ä¸»é”®ï¼ˆPRIMARY KEYï¼‰
- ä¸»é”®ç”¨æ¥å”¯ä¸€æ ‡è¯†æ¯ä¸€æ¡è®°å½•
- ä¿®æ”¹ä¸»é”®ä¼šå½±å“æ•°æ®ä¸€è‡´æ€§
- è¿™æ˜¯æ•°æ®åº“è®¾è®¡çš„æœ€ä½³å®è·µ

### Q4ï¼šé”™è¯¯å¤„ç†æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ
**Aï¼š**
```python
try:
    # å°è¯•æ‰§è¡Œæ“ä½œ
    db.session.commit()
except Exception as e:
    # å‡ºé”™å°±å›æ»š
    db.session.rollback()
    # è¿”å›é”™è¯¯ä¿¡æ¯
    return jsonify({'code': 500, 'message': str(e)})
```

---

## ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®

1. **å­¦ä¹  Vue åŸºç¡€**
   - ç»„ä»¶ã€propsã€äº‹ä»¶
   - refã€reactiveã€computed
   - ç”Ÿå‘½å‘¨æœŸ

2. **å­¦ä¹  Flask åŸºç¡€**
   - è·¯ç”±ã€è¯·æ±‚ã€å“åº”
   - SQLAlchemy ORM
   - è“å›¾ã€ä¸­é—´ä»¶

3. **å­¦ä¹  SQL**
   - SELECTã€INSERTã€UPDATEã€DELETE
   - WHEREã€JOINã€GROUP BY
   - ç´¢å¼•ã€äº‹åŠ¡

4. **å­¦ä¹  HTTP**
   - è¯·æ±‚æ–¹æ³•ï¼ˆGETã€POSTã€PUTã€DELETEï¼‰
   - çŠ¶æ€ç ï¼ˆ200ã€404ã€500ï¼‰
   - CORSã€Cookieã€Session

å¸Œæœ›è¿™ä»½æ•™ç¨‹èƒ½å¸®åŠ©ä½ ç†è§£å¢åˆ æ”¹æŸ¥çš„å®ç°åŸç†ï¼å¦‚æœè¿˜æœ‰ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œéšæ—¶é—®æˆ‘ï¼ ğŸ˜Š
