# æœç´¢åŠŸèƒ½å®ç°è¯´æ˜

## âœ… å·²å®ç°åŠŸèƒ½

### 1. æœç´¢åŠŸèƒ½
- âœ… è¾“å…¥ç”¨æˆ·åï¼ˆæ”¯æŒæ¨¡ç³Šæœç´¢ï¼‰
- âœ… ç‚¹å‡»"æœç´¢"æŒ‰é’®æŸ¥è¯¢
- âœ… æ˜¾ç¤ºåŒ¹é…çš„ç”¨æˆ·åˆ—è¡¨
- âœ… å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œæ˜¾ç¤ºæç¤ºï¼š"æœªæ‰¾åˆ°ç”¨æˆ·ååŒ…å«'xxx'çš„ç”¨æˆ·"

### 2. é‡ç½®åŠŸèƒ½
- âœ… ç‚¹å‡»"é‡ç½®"æŒ‰é’®
- âœ… è‡ªåŠ¨æ¸…ç©ºæœç´¢æ¡†
- âœ… é‡æ–°è·å–æ‰€æœ‰ç”¨æˆ·ï¼ˆæ˜¾ç¤ºå®Œæ•´åˆ—è¡¨ï¼‰

---

## ğŸ”§ å®ç°ç»†èŠ‚

### åç«¯ä¿®æ”¹ï¼š`backend/app.py`

```python
@app.route('/api/users', methods=['GET'])
def get_users():
    try:
        # ğŸ“¥ è·å–æœç´¢å‚æ•°
        name = request.args.get('name', '')
        
        # ğŸ” å¦‚æœæœ‰æœç´¢æ¡ä»¶ï¼Œåˆ™æŒ‰ç”¨æˆ·åæ¨¡ç³Šæœç´¢
        if name:
            users = User.query.filter(User.name.like(f'%{name}%')).all()
        else:
            users = User.query.all()
        
        user_list = [u.to_dict() for u in users]
        return jsonify({
            'code': 200,
            'data': {
                'list': user_list,
                'pageTotal': len(user_list)
            }
        })
    except Exception as e:
        return jsonify({'code': 500, 'message': str(e)}), 500
```

**è§£é‡Šï¼š**
- `request.args.get('name', '')` - ä» URL å‚æ•°ä¸­è·å– `name`
- `User.name.like(f'%{name}%')` - æ¨¡ç³ŠæŸ¥è¯¢ï¼Œç›¸å½“äº SQLï¼š`WHERE name LIKE '%admin%'`
- `%` æ˜¯é€šé…ç¬¦ï¼Œè¡¨ç¤ºä»»æ„å­—ç¬¦

**SQL ç­‰ä»·ï¼š**
```sql
-- æœç´¢åŒ…å« "admin" çš„ç”¨æˆ·
SELECT * FROM tb_user WHERE name LIKE '%admin%';

-- ç»“æœï¼šadmin, administrator, superadmin ç­‰éƒ½ä¼šè¢«æ‰¾åˆ°
```

### å‰ç«¯ API ä¿®æ”¹ï¼š`src/api/index.ts`

```typescript
// ç”¨æˆ·æ•°æ® - æ”¯æŒä¼ é€’æŸ¥è¯¢å‚æ•°
export const fetchUserData = (params?: any) => {
    return request({
        url: '/users',
        method: 'get',
        params  // ğŸ“¤ ä¼ é€’æŸ¥è¯¢å‚æ•°
    });
};
```

**è§£é‡Šï¼š**
- `params?: any` - å¯é€‰å‚æ•°ï¼Œç”¨äºä¼ é€’æœç´¢æ¡ä»¶
- Axios ä¼šè‡ªåŠ¨æŠŠ `params` è½¬æ¢æˆ URL å‚æ•°
- ä¾‹å¦‚ï¼š`params: {name: 'admin'}` â†’ `/users?name=admin`

### å‰ç«¯é¡µé¢ä¿®æ”¹ï¼š`src/views/system/user.vue`

#### 1. æœç´¢æŒ‰é’®å¤„ç†

```typescript
// ğŸ” æœç´¢æŒ‰é’®ï¼šæ ¹æ®è¾“å…¥çš„ç”¨æˆ·åæœç´¢
const handleSearch = () => {
    page.index = 1;  // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
    getData();       // é‡æ–°è·å–æ•°æ®
};
```

#### 2. è·å–æ•°æ®å‡½æ•°ï¼ˆæ”¯æŒæœç´¢ï¼‰

```typescript
// ğŸ“Š è·å–æ•°æ®ï¼šæ”¯æŒæœç´¢å‚æ•°
const getData = async () => {
    try {
        // ğŸ”§ æ„å»ºæŸ¥è¯¢å‚æ•°
        const params: any = {};
        if (query.name) {
            params.name = query.name;
        }
        
        // ğŸ“¡ å‘é€è¯·æ±‚
        const res = await fetchUserData(params);
        tableData.value = res.data.data.list;
        page.total = res.data.data.pageTotal;
        
        // âš ï¸ å¦‚æœæœç´¢ç»“æœä¸ºç©ºï¼Œæ˜¾ç¤ºæç¤º
        if (tableData.value.length === 0 && query.name) {
            ElMessage.warning(`æœªæ‰¾åˆ°ç”¨æˆ·ååŒ…å«"${query.name}"çš„ç”¨æˆ·`);
        }
    } catch (error: any) {
        ElMessage.error('è·å–æ•°æ®å¤±è´¥');
    }
};
```

#### 3. é‡ç½®åŠŸèƒ½ï¼ˆç»„ä»¶è‡ªå¸¦ï¼‰

`TableSearch` ç»„ä»¶å·²ç»å†…ç½®äº†é‡ç½®åŠŸèƒ½ï¼š

```typescript
// ğŸ”„ é‡ç½®è¡¨å•
const resetForm = (formEl: FormInstance | undefined) => {
    if (!formEl) return
    formEl.resetFields()  // æ¸…ç©ºæ‰€æœ‰è¡¨å•å­—æ®µ
    props.search();       // é‡æ–°æœç´¢ï¼ˆè·å–æ‰€æœ‰æ•°æ®ï¼‰
}
```

---

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### åœºæ™¯ 1ï¼šæœç´¢ç”¨æˆ·

1. åœ¨æœç´¢æ¡†è¾“å…¥ç”¨æˆ·åï¼ˆä¾‹å¦‚ï¼š`admin`ï¼‰
2. ç‚¹å‡»"æœç´¢"æŒ‰é’®
3. é¡µé¢åªæ˜¾ç¤ºç”¨æˆ·ååŒ…å« "admin" çš„ç”¨æˆ·
4. å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œæ˜¾ç¤ºæç¤ºï¼š"æœªæ‰¾åˆ°ç”¨æˆ·ååŒ…å«'admin'çš„ç”¨æˆ·"

**ç¤ºä¾‹ï¼š**
```
è¾“å…¥: "admin"
ç»“æœ: admin, administrator (å¦‚æœæœ‰çš„è¯)

è¾“å…¥: "å¼ "
ç»“æœ: å¼ ä¸‰, å¼ å››, å°å¼  (æ‰€æœ‰åŒ…å«"å¼ "çš„ç”¨æˆ·)

è¾“å…¥: "xyz"
ç»“æœ: æç¤º "æœªæ‰¾åˆ°ç”¨æˆ·ååŒ…å«'xyz'çš„ç”¨æˆ·"
```

### åœºæ™¯ 2ï¼šé‡ç½®æœç´¢

1. ç‚¹å‡»"é‡ç½®"æŒ‰é’®
2. æœç´¢æ¡†è‡ªåŠ¨æ¸…ç©º
3. é¡µé¢æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·ï¼ˆæ¢å¤åˆ°åˆå§‹çŠ¶æ€ï¼‰

---

## ğŸ” å®Œæ•´æµç¨‹ç¤ºä¾‹

### æœç´¢æµç¨‹

```
1. ğŸ‘¤ ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥ "111"
   â†“
2. ğŸ–±ï¸ ç”¨æˆ·ç‚¹å‡»"æœç´¢"æŒ‰é’®
   â†“
3. ğŸ¨ å‰ç«¯è°ƒç”¨ handleSearch()
   â†“
4. ğŸ“Š å‰ç«¯è°ƒç”¨ getData()
   æ„å»ºå‚æ•°: params = { name: '111' }
   â†“
5. ğŸ“¡ å‰ç«¯è°ƒç”¨ fetchUserData({ name: '111' })
   â†“
6. ğŸŒ å‘é€ GET è¯·æ±‚: /api/users?name=111
   â†“
7. ğŸ”§ åç«¯æ¥æ”¶è¯·æ±‚
   name = request.args.get('name')  # name = '111'
   â†“
8. ğŸ’¾ åç«¯æŸ¥è¯¢æ•°æ®åº“
   User.query.filter(User.name.like('%111%')).all()
   
   ç­‰ä»· SQL:
   SELECT * FROM tb_user WHERE name LIKE '%111%';
   â†“
9. ğŸ“¤ åç«¯è¿”å›ç»“æœ
   {
     "code": 200,
     "data": {
       "list": [{"name":"111", ...}],
       "pageTotal": 1
     }
   }
   â†“
10. ğŸ¨ å‰ç«¯æ¥æ”¶æ•°æ®
   tableData.value = [{"name":"111", ...}]
   â†“
11. ğŸ“º é¡µé¢åªæ˜¾ç¤ºç”¨æˆ· "111"
```

### é‡ç½®æµç¨‹

```
1. ğŸ‘¤ ç”¨æˆ·ç‚¹å‡»"é‡ç½®"æŒ‰é’®
   â†“
2. ğŸ¨ å‰ç«¯è°ƒç”¨ resetForm()
   â†“
3. ğŸ§¹ æ¸…ç©ºæœç´¢æ¡†
   formEl.resetFields()
   query.name = ''
   â†“
4. ğŸ“Š å‰ç«¯è°ƒç”¨ getData()
   æ„å»ºå‚æ•°: params = {} (ç©ºå¯¹è±¡ï¼Œå› ä¸º query.name ä¸ºç©º)
   â†“
5. ğŸ“¡ å‰ç«¯è°ƒç”¨ fetchUserData({})
   â†“
6. ğŸŒ å‘é€ GET è¯·æ±‚: /api/users (æ²¡æœ‰æŸ¥è¯¢å‚æ•°)
   â†“
7. ğŸ”§ åç«¯æ¥æ”¶è¯·æ±‚
   name = request.args.get('name', '')  # name = ''
   â†“
8. ğŸ’¾ åç«¯æŸ¥è¯¢æ•°æ®åº“
   User.query.all()  # æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
   
   ç­‰ä»· SQL:
   SELECT * FROM tb_user;
   â†“
9. ğŸ“¤ åç«¯è¿”å›æ‰€æœ‰ç”¨æˆ·
   â†“
10. ğŸ“º é¡µé¢æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·ï¼ˆæ¢å¤åˆå§‹çŠ¶æ€ï¼‰
```

---

## ğŸ§ª æµ‹è¯•ç¤ºä¾‹

### æµ‹è¯• 1ï¼šæœç´¢å­˜åœ¨çš„ç”¨æˆ·

**æ“ä½œï¼š**
1. åœ¨æœç´¢æ¡†è¾“å…¥ `admin`
2. ç‚¹å‡»"æœç´¢"

**é¢„æœŸç»“æœï¼š**
- âœ… é¡µé¢åªæ˜¾ç¤º `admin` ç”¨æˆ·
- âœ… å…± 7 æ¡ â†’ å…± 1 æ¡

### æµ‹è¯• 2ï¼šæœç´¢ä¸å­˜åœ¨çš„ç”¨æˆ·

**æ“ä½œï¼š**
1. åœ¨æœç´¢æ¡†è¾“å…¥ `ä¸å­˜åœ¨çš„ç”¨æˆ·`
2. ç‚¹å‡»"æœç´¢"

**é¢„æœŸç»“æœï¼š**
- âœ… é¡µé¢æ˜¾ç¤º"æš‚æ— æ•°æ®"
- âœ… å¼¹å‡ºæç¤ºï¼š"æœªæ‰¾åˆ°ç”¨æˆ·ååŒ…å«'ä¸å­˜åœ¨çš„ç”¨æˆ·'çš„ç”¨æˆ·"

### æµ‹è¯• 3ï¼šæ¨¡ç³Šæœç´¢

**æ“ä½œï¼š**
1. åœ¨æœç´¢æ¡†è¾“å…¥ `1`
2. ç‚¹å‡»"æœç´¢"

**é¢„æœŸç»“æœï¼š**
- âœ… æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·ååŒ…å« `1` çš„ç”¨æˆ·
- âœ… ä¾‹å¦‚ï¼š`111`, `12`, `test11` ç­‰

### æµ‹è¯• 4ï¼šé‡ç½®åŠŸèƒ½

**æ“ä½œï¼š**
1. å…ˆæœç´¢ `admin`ï¼ˆåªæ˜¾ç¤º 1 ä¸ªç”¨æˆ·ï¼‰
2. ç‚¹å‡»"é‡ç½®"

**é¢„æœŸç»“æœï¼š**
- âœ… æœç´¢æ¡†è‡ªåŠ¨æ¸…ç©º
- âœ… é¡µé¢æ¢å¤æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·
- âœ… å…± 1 æ¡ â†’ å…± 7 æ¡

---

## ğŸ“ æŠ€æœ¯è¦ç‚¹

### 1. URL æŸ¥è¯¢å‚æ•°

```
å‰ç«¯å‘é€:
  fetchUserData({ name: 'admin' })

Axios è½¬æ¢ä¸º:
  GET /api/users?name=admin

åç«¯æ¥æ”¶:
  name = request.args.get('name')  # 'admin'
```

### 2. SQL æ¨¡ç³ŠæŸ¥è¯¢

```python
# Python SQLAlchemy
User.name.like(f'%{name}%')

# ç­‰ä»· SQL
WHERE name LIKE '%admin%'

# % çš„å«ä¹‰ï¼š
# %admin  â†’ ä»¥ admin ç»“å°¾ï¼ˆxxadminï¼‰
# admin%  â†’ ä»¥ admin å¼€å¤´ï¼ˆadminxxï¼‰
# %admin% â†’ åŒ…å« adminï¼ˆxxadminxxï¼‰
```

### 3. æ¡ä»¶åˆ¤æ–­

```python
if name:
    # æœ‰æœç´¢æ¡ä»¶ï¼šæ¨¡ç³ŠæŸ¥è¯¢
    users = User.query.filter(User.name.like(f'%{name}%')).all()
else:
    # æ²¡æœ‰æœç´¢æ¡ä»¶ï¼šæŸ¥è¯¢æ‰€æœ‰
    users = User.query.all()
```

### 4. å‰ç«¯å‚æ•°æ„å»º

```typescript
const params: any = {};
if (query.name) {
    params.name = query.name;
}

// å¦‚æœ query.name ä¸ºç©ºï¼Œparams = {}
// å¦‚æœ query.name = 'admin'ï¼Œparams = { name: 'admin' }
```

---

## ğŸš€ æ‰©å±•åŠŸèƒ½å»ºè®®

### 1. å¤šæ¡ä»¶æœç´¢

```typescript
// å‰ç«¯
const params: any = {};
if (query.name) params.name = query.name;
if (query.role) params.role = query.role;
if (query.department) params.department = query.department;

// åç«¯
@app.route('/api/users', methods=['GET'])
def get_users():
    query = User.query
    
    name = request.args.get('name')
    if name:
        query = query.filter(User.name.like(f'%{name}%'))
    
    role = request.args.get('role')
    if role:
        query = query.filter(User.role.like(f'%{role}%'))
    
    users = query.all()
    # ...
```

### 2. ç²¾ç¡®æœç´¢ vs æ¨¡ç³Šæœç´¢

```python
# æ¨¡ç³Šæœç´¢ï¼ˆå½“å‰å®ç°ï¼‰
User.name.like(f'%{name}%')  # åŒ…å«

# ç²¾ç¡®æœç´¢
User.name == name  # å®Œå…¨åŒ¹é…

# å‰ç¼€æœç´¢
User.name.like(f'{name}%')  # ä»¥ name å¼€å¤´
```

### 3. ä¸åŒºåˆ†å¤§å°å†™

```python
# SQLAlchemy
from sqlalchemy import func
User.query.filter(func.lower(User.name).like(f'%{name.lower()}%'))

# MySQL
SELECT * FROM tb_user WHERE LOWER(name) LIKE LOWER('%admin%');
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: æœç´¢ä¸ç”Ÿæ•ˆï¼Ÿ
**A:** æ£€æŸ¥ï¼š
1. åç«¯æ˜¯å¦é‡å¯ï¼ˆFlask éœ€è¦é‡å¯æ‰èƒ½åŠ è½½æ–°ä»£ç ï¼‰
2. æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯·æ±‚ URL æ˜¯å¦åŒ…å«æŸ¥è¯¢å‚æ•°
3. åç«¯æ—¥å¿—æŸ¥çœ‹ SQL è¯­å¥

### Q2: ä¸­æ–‡æœç´¢ä¹±ç ï¼Ÿ
**A:** ç¡®ä¿ï¼š
1. æ•°æ®åº“å­—ç¬¦é›†ä¸º `utf8mb4`
2. Python æ–‡ä»¶ç¼–ç ä¸º UTF-8
3. Flask é…ç½® `JSON_AS_ASCII = False`

### Q3: æœç´¢ç»“æœä¸å‡†ç¡®ï¼Ÿ
**A:** æ£€æŸ¥ï¼š
1. ä½¿ç”¨ `%{name}%` è€Œä¸æ˜¯ `{name}`
2. SQL æ˜¯å¦æ­£ç¡®ï¼š`LIKE '%admin%'`

### Q4: é‡ç½®åè¿˜æ˜¾ç¤ºæ—§æ•°æ®ï¼Ÿ
**A:** ç¡®ä¿ï¼š
1. `resetFields()` æ­£ç¡®æ¸…ç©ºäº†è¡¨å•
2. æ¸…ç©ºåè°ƒç”¨äº† `props.search()`
3. `getData()` ä¸­æ­£ç¡®åˆ¤æ–­äº†ç©ºå‚æ•°

---

## âœ… æ€»ç»“

ç°åœ¨ç”¨æˆ·ç®¡ç†é¡µé¢å·²ç»å…·å¤‡å®Œæ•´çš„æœç´¢åŠŸèƒ½ï¼š

1. **æœç´¢åŠŸèƒ½** âœ…
   - è¾“å…¥ç”¨æˆ·å â†’ ç‚¹å‡»æœç´¢ â†’ æ˜¾ç¤ºåŒ¹é…ç»“æœ
   - æ”¯æŒæ¨¡ç³Šæœç´¢ï¼ˆåŒ…å«å³åŒ¹é…ï¼‰
   - æ— ç»“æœæ—¶æ˜¾ç¤ºå‹å¥½æç¤º

2. **é‡ç½®åŠŸèƒ½** âœ…
   - ç‚¹å‡»é‡ç½® â†’ æ¸…ç©ºæœç´¢æ¡† â†’ æ˜¾ç¤ºæ‰€æœ‰æ•°æ®

3. **ç”¨æˆ·ä½“éªŒ** âœ…
   - å³æ—¶åé¦ˆï¼ˆæˆåŠŸ/å¤±è´¥æç¤ºï¼‰
   - ç©ºç»“æœæç¤º
   - å¹³æ»‘çš„äº¤äº’æµç¨‹

**ç°åœ¨åˆ·æ–°æµè§ˆå™¨ï¼Œè¯•è¯•æœç´¢åŠŸèƒ½å§ï¼** ğŸ‰
